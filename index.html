<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitTrack - Фитнес трекер</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        .progress-ring__circle {
            transition: stroke-dashoffset 0.5s;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }
        .slide-in {
            animation: slideIn 0.3s forwards;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .bar {
            transition: height 0.5s ease-out;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans">
    <div class="container mx-auto max-w-md min-h-screen bg-white shadow-lg relative overflow-hidden">
        <!-- Header -->
        <header class="bg-gradient-to-r from-indigo-500 to-purple-600 text-white p-4 shadow-md">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-xl font-bold">FitTrack</h1>
                    <p class="text-xs opacity-80">Ваш персональный фитнес-помощник</p>
                </div>
                <div class="relative">
                    <div id="userAvatar" class="w-10 h-10 rounded-full bg-white flex items-center justify-center text-indigo-600 font-bold">
                        <i class="fas fa-user"></i>
                    </div>
                    <div id="notificationBadge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center hidden">3</div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="p-4 pb-20">
            <!-- Statistics Section -->
            <div class="bg-white rounded-xl shadow-md p-4 mb-4 fade-in">
                <div class="flex justify-between items-center mb-3">
                    <h2 class="font-bold text-lg">Статистика тренировок</h2>
                    <span class="text-sm text-gray-500" id="currentWeek">Эта неделя</span>
                </div>
                
                <div class="flex items-end justify-between h-40 mb-4 border-b border-gray-200">
                    <!-- Bars will be added here dynamically -->
                    <div class="flex-1 flex flex-col items-center">
                        <div class="bar bg-indigo-500 w-6 rounded-t mb-1" style="height: 30%;"></div>
                        <span class="text-xs text-gray-500">Пн</span>
                    </div>
                    <div class="flex-1 flex flex-col items-center">
                        <div class="bar bg-indigo-500 w-6 rounded-t mb-1" style="height: 60%;"></div>
                        <span class="text-xs text-gray-500">Вт</span>
                    </div>
                    <div class="flex-1 flex flex-col items-center">
                        <div class="bar bg-indigo-500 w-6 rounded-t mb-1" style="height: 45%;"></div>
                        <span class="text-xs text-gray-500">Ср</span>
                    </div>
                    <div class="flex-1 flex flex-col items-center">
                        <div class="bar bg-indigo-500 w-6 rounded-t mb-1" style="height: 80%;"></div>
                        <span class="text-xs text-gray-500">Чт</span>
                    </div>
                    <div class="flex-1 flex flex-col items-center">
                        <div class="bar bg-indigo-500 w-6 rounded-t mb-1" style="height: 25%;"></div>
                        <span class="text-xs text-gray-500">Пт</span>
                    </div>
                    <div class="flex-1 flex flex-col items-center">
                        <div class="bar bg-indigo-500 w-6 rounded-t mb-1" style="height: 65%;"></div>
                        <span class="text-xs text-gray-500">Сб</span>
                    </div>
                    <div class="flex-1 flex flex-col items-center">
                        <div class="bar bg-indigo-500 w-6 rounded-t mb-1" style="height: 40%;"></div>
                        <span class="text-xs text-gray-500">Вс</span>
                    </div>
                </div>
                
                <div class="flex justify-between text-sm">
                    <div class="text-indigo-600 font-medium">
                        <i class="fas fa-fire mr-1"></i> 24 упражнения
                    </div>
                    <div class="text-gray-500">
                        +15% к прошлой неделе
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="grid grid-cols-4 gap-2 mb-6">
                <button onclick="startWorkout()" class="bg-indigo-100 text-indigo-700 rounded-lg p-2 flex flex-col items-center">
                    <i class="fas fa-dumbbell mb-1"></i>
                    <span class="text-xs">Тренировка</span>
                </button>
                <button onclick="showWaterTracker()" class="bg-blue-100 text-blue-700 rounded-lg p-2 flex flex-col items-center">
                    <i class="fas fa-tint mb-1"></i>
                    <span class="text-xs">Вода</span>
                </button>
                <button onclick="showNutrition()" class="bg-green-100 text-green-700 rounded-lg p-2 flex flex-col items-center">
                    <i class="fas fa-utensils mb-1"></i>
                    <span class="text-xs">Питание</span>
                </button>
                <button onclick="showStats()" class="bg-purple-100 text-purple-700 rounded-lg p-2 flex flex-col items-center">
                    <i class="fas fa-chart-line mb-1"></i>
                    <span class="text-xs">Подробнее</span>
                </button>
            </div>

            <!-- Workout Plans -->
            <div class="mb-6">
                <div class="flex justify-between items-center mb-3">
                    <h2 class="font-bold text-lg">Программы тренировок</h2>
                    <button onclick="showAllPlans()" class="text-indigo-600 text-sm">Все</button>
                </div>
                
                <div class="overflow-x-auto">
                    <div class="flex space-x-3 pb-2">
                        <div onclick="showPlanDetails('beginner')" class="min-w-[150px] bg-gradient-to-br from-blue-400 to-blue-600 text-white rounded-xl p-3 shadow-md cursor-pointer">
                            <div class="font-bold mb-1">Для начинающих</div>
                            <div class="text-xs opacity-80">4 недели</div>
                            <div class="text-xs mt-2"><i class="fas fa-calendar-alt mr-1"></i> 3 дня/нед</div>
                        </div>
                        <div onclick="showPlanDetails('weightloss')" class="min-w-[150px] bg-gradient-to-br from-purple-400 to-purple-600 text-white rounded-xl p-3 shadow-md cursor-pointer">
                            <div class="font-bold mb-1">Похудение</div>
                            <div class="text-xs opacity-80">8 недель</div>
                            <div class="text-xs mt-2"><i class="fas fa-calendar-alt mr-1"></i> 5 дней/нед</div>
                        </div>
                        <div onclick="showPlanDetails('strength')" class="min-w-[150px] bg-gradient-to-br from-red-400 to-red-600 text-white rounded-xl p-3 shadow-md cursor-pointer">
                            <div class="font-bold mb-1">Силовая</div>
                            <div class="text-xs opacity-80">12 недель</div>
                            <div class="text-xs mt-2"><i class="fas fa-calendar-alt mr-1"></i> 4 дня/нед</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Motivation -->
            <div class="bg-gradient-to-r from-pink-500 to-orange-500 text-white rounded-xl p-4 mb-6 shadow-lg relative overflow-hidden">
                <div class="relative z-10">
                    <div class="font-bold mb-2">Мотивация дня</div>
                    <div class="text-sm mb-3" id="dailyQuote">"Неважно, как медленно ты продвигаешься. Главное — ты не останавливаешься."</div>
                    <button onclick="refreshQuote()" class="bg-white bg-opacity-20 text-white text-xs px-3 py-1 rounded-full backdrop-blur-sm">
                        <i class="fas fa-sync-alt mr-1"></i> Новая цитата
                    </button>
                </div>
                <div class="absolute -bottom-4 -right-4 text-white opacity-20 text-6xl">
                    <i class="fas fa-quote-right"></i>
                </div>
            </div>

            <!-- Recent Activity -->
            <div>
                <h2 class="font-bold text-lg mb-3">Недавняя активность</h2>
                <div class="space-y-3">
                    <div class="flex items-center bg-gray-50 rounded-lg p-3">
                        <div class="bg-indigo-100 text-indigo-600 w-10 h-10 rounded-full flex items-center justify-center mr-3">
                            <i class="fas fa-running"></i>
                        </div>
                        <div>
                            <div class="font-medium">Утренняя пробежка</div>
                            <div class="text-xs text-gray-500">Сегодня, 7:30 - 25 мин</div>
                        </div>
                        <div class="ml-auto text-indigo-600 font-bold">320 ккал</div>
                    </div>
                    <div class="flex items-center bg-gray-50 rounded-lg p-3">
                        <div class="bg-blue-100 text-blue-600 w-10 h-10 rounded-full flex items-center justify-center mr-3">
                            <i class="fas fa-dumbbell"></i>
                        </div>
                        <div>
                            <div class="font-medium">Силовая тренировка</div>
                            <div class="text-xs text-gray-500">Вчера, 18:15 - 45 мин</div>
                        </div>
                        <div class="ml-auto text-blue-600 font-bold">450 ккал</div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Bottom Navigation -->
        <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 flex justify-around items-center p-2 max-w-md mx-auto">
            <button class="p-2 text-indigo-600">
                <i class="fas fa-home text-xl"></i>
            </button>
            <button onclick="showWorkouts()" class="p-2 text-gray-500">
                <i class="fas fa-dumbbell text-xl"></i>
            </button>
            <button onclick="showProgress()" class="p-2 text-gray-500">
                <i class="fas fa-chart-pie text-xl"></i>
            </button>
            <button onclick="showProfile()" class="p-2 text-gray-500">
                <i class="fas fa-user text-xl"></i>
            </button>
        </nav>

        <!-- Modals and Overlays -->
        <div id="waterModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-xl p-6 w-80 slide-in">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-bold text-lg">Трекер воды</h3>
                    <button onclick="hideWaterTracker()" class="text-gray-500">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="text-center mb-6">
                    <div class="relative w-40 h-40 mx-auto mb-4">
                        <svg class="w-full h-full" viewBox="0 0 100 100">
                            <circle class="text-gray-200" stroke-width="8" stroke="currentColor" fill="transparent" r="40" cx="50" cy="50" />
                            <circle class="text-blue-500 progress-ring__circle" stroke-width="8" stroke-linecap="round" stroke="currentColor" fill="transparent" r="40" cx="50" cy="50" stroke-dasharray="251.2" stroke-dashoffset="175.84" />
                        </svg>
                        <div class="absolute inset-0 flex items-center justify-center flex-col">
                            <div class="text-3xl font-bold text-blue-600" id="waterGlasses">4</div>
                            <div class="text-sm text-gray-500">из 8 стаканов</div>
                        </div>
                    </div>
                    <div class="text-sm text-gray-600 mb-4">Рекомендуется 2 литра воды в день</div>
                    <div class="flex justify-center space-x-3">
                        <button onclick="addWater(-1)" class="bg-gray-200 text-gray-700 w-10 h-10 rounded-full flex items-center justify-center">
                            <i class="fas fa-minus"></i>
                        </button>
                        <button onclick="addWater(1)" class="bg-blue-500 text-white w-10 h-10 rounded-full flex items-center justify-center pulse-animation">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div id="workoutModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-xl p-6 w-80 max-h-[80vh] overflow-y-auto slide-in">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-bold text-lg" id="workoutTitle">Тренировка</h3>
                    <button onclick="hideWorkoutModal()" class="text-gray-500">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div id="workoutContent">
                    <!-- Content will be loaded here -->
                </div>
                <button onclick="startActiveWorkout()" class="mt-4 w-full bg-indigo-600 text-white py-2 rounded-lg font-bold">
                    Начать тренировку
                </button>
            </div>
        </div>

        <div id="activeWorkoutModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-xl p-6 w-80 max-h-[80vh] overflow-y-auto slide-in">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-bold text-lg">Тренировка</h3>
                    <div class="text-gray-500 font-mono" id="workoutTimer">00:00</div>
                </div>
                <div class="mb-4">
                    <div class="font-medium mb-2" id="currentExercise">Разминка</div>
                    <div class="text-sm text-gray-500 mb-3" id="exerciseDescription">Сделайте легкую разминку в течение 5 минут</div>
                    <div class="flex justify-between text-xs text-gray-500">
                        <span>Предыдущее</span>
                        <span>Следующее</span>
                    </div>
                    <div class="relative h-2 bg-gray-200 rounded-full overflow-hidden mt-1">
                        <div id="exerciseProgress" class="absolute top-0 left-0 h-full bg-indigo-500 rounded-full" style="width: 0%"></div>
                    </div>
                </div>
                <div class="space-y-3" id="workoutExercises">
                    <!-- Exercises will be listed here -->
                </div>
                <div class="flex space-x-3 mt-4">
                    <button onclick="pauseWorkout()" class="flex-1 bg-gray-200 text-gray-700 py-2 rounded-lg font-medium">
                        Пауза
                    </button>
                    <button onclick="finishWorkout()" class="flex-1 bg-indigo-600 text-white py-2 rounded-lg font-bold">
                        Завершить
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Telegram WebApp initialization
        const tg = window.Telegram.WebApp;
        tg.expand();
        
        // Set theme colors from Telegram
        document.documentElement.style.setProperty('--tg-theme-bg-color', tg.themeParams.bg_color || '#ffffff');
        document.documentElement.style.setProperty('--tg-theme-text-color', tg.themeParams.text_color || '#000000');
        document.documentElement.style.setProperty('--tg-theme-hint-color', tg.themeParams.hint_color || '#707579');
        document.documentElement.style.setProperty('--tg-theme-link-color', tg.themeParams.link_color || '#3390ec');
        document.documentElement.style.setProperty('--tg-theme-button-color', tg.themeParams.button_color || '#3390ec');
        document.documentElement.style.setProperty('--tg-theme-button-text-color', tg.themeParams.button_text_color || '#ffffff');
        
        // User data
        const user = {
            name: tg.initDataUnsafe.user?.first_name || 'Пользователь',
            avatar: tg.initDataUnsafe.user?.photo_url,
            waterGoal: 8,
            currentWater: 4
        };
        
        // State
        let state = {
            workoutActive: false,
            workoutTime: 0,
            workoutTimer: null,
            currentExerciseIndex: 0,
            // Weekly workout data (exercises count per day)
            weeklyStats: [5, 12, 9, 16, 4, 13, 8],
            maxExercises: 20 // For scaling the chart
        };
        
        // Quotes
        const quotes = [
            "Неважно, как медленно ты продвигаешься. Главное — ты не останавливаешься.",
            "Дисциплина — это мост между целями и достижениями.",
            "Тело достигает того, во что верит разум.",
            "Сегодняшние жертвы — завтрашние результаты.",
            "Сила не в том, сколько ты можешь поднять, а в том, сколько раз ты можешь подняться.",
            "Прогресс требует времени. Будь терпелив и последователен.",
            "Ты ближе к своей цели, чем был вчера."
        ];
        
        // Workout plans
        const workoutPlans = {
            beginner: {
                title: "Для начинающих",
                duration: "4 недели",
                frequency: "3 дня в неделю",
                description: "Эта программа идеально подходит для тех, кто только начинает свой фитнес-путь. Она включает в себя базовые упражнения для развития силы и выносливости.",
                exercises: [
                    { name: "Разминка", duration: 5, description: "Легкая разминка: ходьба на месте, махи руками, вращения суставов" },
                    { name: "Приседания", duration: 3, description: "3 подхода по 10 повторений" },
                    { name: "Отжимания (с колен)", duration: 3, description: "3 подхода по 8 повторений" },
                    { name: "Планка", duration: 1, description: "Удержание 30 секунд" },
                    { name: "Выпады", duration: 3, description: "3 подхода по 8 повторений на каждую ногу" },
                    { name: "Подъемы корпуса", duration: 3, description: "3 подхода по 12 повторений" },
                    { name: "Заминка", duration: 5, description: "Растяжка всех групп мышц" }
                ]
            },
            weightloss: {
                title: "Похудение",
                duration: "8 недель",
                frequency: "5 дней в неделю",
                description: "Интенсивная программа, направленная на сжигание жира и улучшение общего тонуса организма. Сочетает кардио и силовые упражнения.",
                exercises: [
                    { name: "Разминка", duration: 5, description: "Легкий бег на месте или прыжки со скакалкой" },
                    { name: "Берпи", duration: 4, description: "4 подхода по 12 повторений" },
                    { name: "Прыжки в планке", duration: 3, description: "3 подхода по 15 секунд" },
                    { name: "Приседания с прыжком", duration: 3, description: "3 подхода по 10 повторений" },
                    { name: "Скалолаз", duration: 3, description: "3 подхода по 20 секунд" },
                    { name: "Прыжки на скамью", duration: 3, description: "3 подхода по 10 повторений" },
                    { name: "Заминка", duration: 5, description: "Растяжка и глубокое дыхание" }
                ]
            },
            strength: {
                title: "Силовая",
                duration: "12 недель",
                frequency: "4 дня в неделю",
                description: "Программа для развития силы и мышечной массы. Требует наличия гантелей или другого отягощения.",
                exercises: [
                    { name: "Разминка", duration: 5, description: "Разогрев суставов и легкое кардио" },
                    { name: "Жим гантелей", duration: 4, description: "4 подхода по 8-10 повторений" },
                    { name: "Тяга гантелей", duration: 4, description: "4 подхода по 8-10 повторений" },
                    { name: "Приседания с гантелями", duration: 4, description: "4 подхода по 8-10 повторений" },
                    { name: "Выпады с гантелями", duration: 3, description: "3 подхода по 8 повторений на каждую ногу" },
                    { name: "Подъемы на носки", duration: 3, description: "3 подхода по 12-15 повторений" },
                    { name: "Заминка", duration: 5, description: "Растяжка работавших мышц" }
                ]
            }
        };
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Set current date
            const now = new Date();
            const options = { weekday: 'long', day: 'numeric', month: 'long' };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('ru-RU', options);
            
            // Set user avatar if available
            if (user.avatar) {
                document.getElementById('userAvatar').innerHTML = `<img src="${user.avatar}" class="w-full h-full rounded-full object-cover">`;
            } else {
                document.getElementById('userAvatar').textContent = user.name.charAt(0).toUpperCase();
            }
            
            // Initialize statistics chart
            renderStatsChart();
            
            // Update water tracker
            document.getElementById('waterGlasses').textContent = user.currentWater;
            const waterProgress = 251.2 - (user.currentWater / user.waterGoal * 251.2);
            document.querySelector('#waterModal .progress-ring__circle').style.strokeDashoffset = waterProgress;
        });
        
        // Render statistics chart
        function renderStatsChart() {
            const bars = document.querySelectorAll('.bar');
            const totalExercises = state.weeklyStats.reduce((sum, val) => sum + val, 0);
            
            // Update bars height based on data
            state.weeklyStats.forEach((count, index) => {
                const heightPercentage = (count / state.maxExercises) * 100;
                bars[index].style.height = `${heightPercentage}%`;
                
                // Add tooltip with exact count
                bars[index].title = `${count} упражнений`;
            });
            
            // Update total exercises count
            document.querySelector('.text-indigo-600.font-medium').innerHTML = 
                `<i class="fas fa-fire mr-1"></i> ${totalExercises} упражнений`;
        }
        
        // Water tracker functions
        function showWaterTracker() {
            document.getElementById('waterModal').classList.remove('hidden');
        }
        
        function hideWaterTracker() {
            document.getElementById('waterModal').classList.add('hidden');
        }
        
        function addWater(glasses) {
            user.currentWater = Math.max(0, Math.min(user.waterGoal, user.currentWater + glasses));
            document.getElementById('waterGlasses').textContent = user.currentWater;
            const waterProgress = 251.2 - (user.currentWater / user.waterGoal * 251.2);
            document.querySelector('#waterModal .progress-ring__circle').style.strokeDashoffset = waterProgress;
        }
        
        // Workout functions
        function startWorkout() {
            document.getElementById('workoutTitle').textContent = 'Выберите тренировку';
            
            let content = '<div class="space-y-4">';
            for (const [key, plan] of Object.entries(workoutPlans)) {
                content += `
                    <div onclick="showPlanDetails('${key}')" class="border border-gray-200 rounded-lg p-3 cursor-pointer hover:bg-gray-50">
                        <div class="font-bold">${plan.title}</div>
                        <div class="text-sm text-gray-500">${plan.duration}, ${plan.frequency}</div>
                    </div>
                `;
            }
            content += '</div>';
            
            document.getElementById('workoutContent').innerHTML = content;
            document.getElementById('workoutModal').classList.remove('hidden');
        }
        
        function showPlanDetails(planKey) {
            const plan = workoutPlans[planKey];
            document.getElementById('workoutTitle').textContent = plan.title;
            
            let content = `
                <div class="mb-4">
                    <div class="text-sm text-gray-500 mb-2">${plan.duration}, ${plan.frequency}</div>
                    <p class="text-gray-700">${plan.description}</p>
                </div>
                <div class="font-medium mb-2">Упражнения:</div>
                <div class="space-y-3">
            `;
            
            plan.exercises.forEach((exercise, index) => {
                content += `
                    <div class="flex items-start">
                        <div class="bg-indigo-100 text-indigo-600 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold mr-2 mt-0.5 flex-shrink-0">${index + 1}</div>
                        <div>
                            <div class="font-medium">${exercise.name}</div>
                            <div class="text-sm text-gray-500">${exercise.description}</div>
                        </div>
                    </div>
                `;
            });
            
            content += '</div>';
            document.getElementById('workoutContent').innerHTML = content;
        }
        
        function hideWorkoutModal() {
            document.getElementById('workoutModal').classList.add('hidden');
        }
        
        function startActiveWorkout() {
            const plan = workoutPlans['beginner']; // For demo, we'll use beginner plan
            state.workoutActive = true;
            state.workoutTime = 0;
            state.currentExerciseIndex = 0;
            
            document.getElementById('activeWorkoutModal').classList.remove('hidden');
            document.getElementById('workoutModal').classList.add('hidden');
            
            updateActiveWorkoutDisplay(plan);
            
            // Start timer
            state.workoutTimer = setInterval(() => {
                state.workoutTime++;
                const minutes = Math.floor(state.workoutTime / 60).toString().padStart(2, '0');
                const seconds = (state.workoutTime % 60).toString().padStart(2, '0');
                document.getElementById('workoutTimer').textContent = `${minutes}:${seconds}`;
                
                // Simulate exercise progress
                const exercise = plan.exercises[state.currentExerciseIndex];
                const progress = Math.min(100, Math.floor((state.workoutTime % (exercise.duration * 60)) / (exercise.duration * 60) * 100));
                document.getElementById('exerciseProgress').style.width = `${progress}%`;
                
                // Move to next exercise when time is up
                if (state.workoutTime % (exercise.duration * 60) === 0 && state.currentExerciseIndex < plan.exercises.length - 1) {
                    state.currentExerciseIndex++;
                    updateActiveWorkoutDisplay(plan);
                }
            }, 1000);
        }
        
        function updateActiveWorkoutDisplay(plan) {
            const exercise = plan.exercises[state.currentExerciseIndex];
            document.getElementById('currentExercise').textContent = exercise.name;
            document.getElementById('exerciseDescription').textContent = exercise.description;
            
            let exercisesList = '';
            plan.exercises.forEach((ex, index) => {
                exercisesList += `
                    <div class="flex items-center p-2 ${index === state.currentExerciseIndex ? 'bg-indigo-50 rounded-lg' : ''}">
                        <div class="w-6 h-6 rounded-full flex items-center justify-center text-xs mr-2 
                            ${index < state.currentExerciseIndex ? 'bg-green-100 text-green-600' : 
                              index === state.currentExerciseIndex ? 'bg-indigo-600 text-white' : 'bg-gray-100 text-gray-500'}">
                            ${index + 1}
                        </div>
                        <div class="${index < state.currentExerciseIndex ? 'text-gray-400' : ''}">
                            ${ex.name} <span class="text-xs text-gray-500">${ex.duration} мин</span>
                        </div>
                    </div>
                `;
            });
            
            document.getElementById('workoutExercises').innerHTML = exercisesList;
        }
        
        function pauseWorkout() {
            if (state.workoutTimer) {
                clearInterval(state.workoutTimer);
                state.workoutTimer = null;
            }
        }
        
        function finishWorkout() {
            pauseWorkout();
            state.workoutActive = false;
            document.getElementById('activeWorkoutModal').classList.add('hidden');
            
            // Update weekly stats (add random exercises for today)
            const today = new Date().getDay() - 1; // 0-6 (Monday-Sunday)
            if (today >= 0 && today <= 6) {
                state.weeklyStats[today] += Math.floor(Math.random() * 5) + 3;
                renderStatsChart();
            }
            
            // Show completion message
            alert('Тренировка завершена! Отличная работа!');
        }
        
        // Navigation functions
        function showWorkouts() {
            alert('Раздел "Тренировки" будет здесь');
        }
        
        function showProgress() {
            alert('Раздел "Прогресс" будет здесь');
        }
        
        function showProfile() {
            alert('Раздел "Профиль" будет здесь');
        }
        
        function showAllPlans() {
            startWorkout();
        }
        
        function showNutrition() {
            alert('Раздел "Питание" будет здесь');
        }
        
        function showStats() {
            alert('Подробная статистика будет здесь');
        }
        
        // Quote functions
        function refreshQuote() {
            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
            document.getElementById('dailyQuote').textContent = `"${randomQuote}"`;
        }
    </script>
</body>
</html>
